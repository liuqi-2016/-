##  磁盘与文件系统：认识 Ext2 文件系统


1. 特性
{
	1. Linux 的正统文件系统则为 Ext2 (Linux second extended file system, ext2fs)


	2. 文件系统分为两部分：
		
		inode： 存放文件的权限和属性，一个文件占用一个inode，同时记录此文件的数据所在的block号码
		
		datablock：存放实际数据，若文件太大，会占用多个block
		
		superblock：存放整个文件系统的整体信息， inode datablock的总量，使用量，剩余量，文件系统的格式与相关信息等
		
		因为inode记录了数据存放的block号码，那么就能找到数据实际存放的block读取数据，这种数据存取的方式叫：索引式文件系统
			例子：
						---    	---    	---    	---     ---    	---    	---    	---																										
			inode	   |   |   |   |   |   |   | 4 |   |   |   |   |   |   |   |   |																																
						---    	---    	---    	---    	---    	---    	---    	---																																
																																					
						---    	---    	---    	---     ---     ---     ---     ---															
			block	   | 1 |   | 2 |   | 3 |   | 4 |   | 5 |   | 6 |   | 7 |   | 8 |																																
						---    	---    	---    	---     ---     ---     ---     ---																																																							
						---    	---    	---    	---     ---    	---    	---    	---														
					   | 9 |   | 10|   |   |   |   |   |   |   |   |   |   |   |   |																																	
						---    	---    	---    	---  	---    	---    	---    	---																																	
						---    	---    	---    	---     ---    	---    	---    	---													
					   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |																																	
						---    	---    	---    	--- 	---    	---    	---    	---																																	
																																			
			假如一个文件的权限和属性存放在 inode4号，它记录的block号码为, 2  5  6  10，此时操作系统根据整个block号码排列磁盘的阅读
				顺序，可以一下把 4个block内容读取
				
				
		另一种方式叫：闪盘(闪存)，一般为FAT文件系统，这种没有inode，它的每个block号码记录在前一个block中

						------     ---     ---     ---     ------     ---     ---     ---														
					   | 1-10 |   | 2 |   | 3 |   | 4 |   | 5-20 |   | 6 |   | 7 |   | 8 |													
						------     ---     ---     ---     ------     ---     ---     ---														
						---    	------     ---     ---     ---     ---     ---     ---														
					   | 9 |   | 10-5 |   |   |   |   |   |   |   |   |   |   |   |   |													
						---    	------     ---     ---     ---     ---     ---     ---														
						---    	---    	---    	----     ---    											
					   |   |   |   |   |   |   | 20 |   |   |   										
						---    	---    	---    	----     ---    											
			
			只能一个一个block找，磁盘需要转很多全才能找全，读取数据就比较慢
			【碎片整理】就是写入的block太离散，读取文件变慢，通过碎片整理将同一个文件所在不同的block汇整在一起

}		
																
																
2. Ext2文件系统
{

	1. linux在格式化的时候，是区分为多个 区块数据群组(block group)，每个区块数据群组都有独立的inode/datablock/superblock(只是第一个区块数据群组的备份)系统，这样就方便管理
		文件系统最前面都有一个启动扇区，这个启动扇区可以安装启动管理程序，这样就能制作多重引导的环境
		
		区块数据群组包含六个块区：
		
		data block(数据区块)：
			存放文件内容数据，block支持的大小只有：1K   2K  及  4K，仅仅这三种
			
		
		inode table(inode表格)：
			存放文件的权限和属性，以及文件内容所在的block号码，每个inode大小固定为：128bytes
			
			inode记录block号码的区域定义为 12个直接，一个间接，一个双间接和一个三间接
				如果一个文件太大，在记录block号码时就会使用到 间接记录
	

		superblock(超级区块)：
			记录真个file system相关信息，file system必须存在 superblock
			
			每个block group都会含有superblock，但是一个文件系统有且仅有一个superblock，因为只有第一个block group内会含有真正的superblock，
				后续的block group如果有，那么也只是第一个block group内superblock的备份，这样可以进行superblock救援
				
	
		Filesystem Description(文件系统描述说明)：
			这个区段可以描述每个 block group 的开始与结束的 block 号码，以及说明每个区段 (superblock, bitmap, inodemap, data block) 分别介于哪一个 block 号码之间
	

		block bitmap(区块对照表)：
			从 block bitmap 当中可以知道哪些 block 是空的
	
	
		inode bitmap(inode对照表)：
			 inode bitmap 是记录使用与未使用的 inode 号码
	
	
	2. 查询 区段和superblock的信息
	
		命令：
			dumpe2fs [-bh] 装置文件名
			
				-b：理出保留为坏轨的部分
				
				-h：仅列出 superblock的数据
				
			df：这个命令可以查询目前挂载的装置
			
			blkid：这个命令查看目前系统有被格式化的装置

}	
																
																																	
																																	
																																	
																																	
																																	
																																	
																																	
																																	
																																	












